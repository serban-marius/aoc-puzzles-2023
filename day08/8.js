let input =
    "LRRLRRRLRRLRRLRRRLRRLRLLRRRLRRRLRRRLRRRLRRRLRRLLRRRLLRLRRRLRRLRRRLLRRRLRLLRRLRLLRLRLLRRLRRRLRRLLRRRLRRRLRLRRRLRRRLRRRLRRRLRLRRRLLRRRLRRLRRRLRLRRRLRRLRLLLLLRRRLRRRLRRRLRRRLRRLLRLRLRRLRRLLRRRLRRRLRRRLLLRRRLRRRLRRRLRLRRRLLRLRLRRLRRLRRRLRRLRRRLRRRLRRRLRRLLRRRLRRLRRLRLLRRRR\n" +
    "\n" +
    "CTK = (JLT, HRF)\n" +
    "TQH = (DKT, HGB)\n" +
    "HQM = (XPV, TTR)\n" +
    "DLL = (MFK, HHS)\n" +
    "BVD = (BXB, FDB)\n" +
    "TTR = (BJG, MTF)\n" +
    "RPR = (CQL, KHJ)\n" +
    "KND = (TVL, QMF)\n" +
    "SQH = (XNP, MRD)\n" +
    "RXM = (HTR, BXT)\n" +
    "XSF = (BRL, XKR)\n" +
    "DGJ = (DQX, KCQ)\n" +
    "DFV = (KHJ, CQL)\n" +
    "CFC = (DPP, QKL)\n" +
    "NKD = (PVH, HQM)\n" +
    "RHK = (JRS, LJS)\n" +
    "XNB = (LCL, DRX)\n" +
    "JNR = (VMM, FLM)\n" +
    "NNB = (FFQ, XXQ)\n" +
    "RMQ = (NBJ, MND)\n" +
    "FGK = (SLK, QLG)\n" +
    "XBR = (NFS, CJM)\n" +
    "TDN = (XXX, KPX)\n" +
    "FXR = (DRT, KVM)\n" +
    "KKF = (LPC, KFT)\n" +
    "BTC = (NKC, DGJ)\n" +
    "CXP = (VNP, FTX)\n" +
    "XXK = (GRD, BHQ)\n" +
    "HNH = (NMF, FSH)\n" +
    "VBT = (NKC, DGJ)\n" +
    "RRS = (VVR, QXT)\n" +
    "VRM = (NDM, DRP)\n" +
    "GFR = (JPB, JML)\n" +
    "XHS = (LQM, SSV)\n" +
    "LQM = (GNT, RSS)\n" +
    "SBX = (QVJ, RJL)\n" +
    "DQX = (SMD, SMD)\n" +
    "KHC = (FJS, MVX)\n" +
    "FQQ = (HFX, TQS)\n" +
    "KFM = (KKQ, FFV)\n" +
    "HLZ = (MQN, LSB)\n" +
    "QXB = (XXQ, FFQ)\n" +
    "PQT = (HVJ, DPG)\n" +
    "HFX = (LHH, KDV)\n" +
    "RVK = (KVR, MHT)\n" +
    "MCS = (GJG, TGS)\n" +
    "CSP = (LHX, GJH)\n" +
    "HQV = (XXP, HLZ)\n" +
    "MVT = (XFN, LHQ)\n" +
    "FPS = (HTC, MSM)\n" +
    "THS = (FDV, JFM)\n" +
    "BNS = (VXQ, SVF)\n" +
    "PXZ = (BDJ, QHT)\n" +
    "GDV = (PGH, KND)\n" +
    "VPS = (HDP, CXX)\n" +
    "LHX = (FXR, FDJ)\n" +
    "VGN = (SJD, GRV)\n" +
    "FTB = (MFF, DQT)\n" +
    "XPV = (MTF, BJG)\n" +
    "RFT = (KFM, JJN)\n" +
    "FQX = (FHB, GDV)\n" +
    "JRT = (LLV, LDQ)\n" +
    "NVB = (RDQ, KQJ)\n" +
    "BHF = (KHT, HCL)\n" +
    "FJS = (BNQ, QGB)\n" +
    "KLV = (JFF, CFH)\n" +
    "CMK = (LJS, JRS)\n" +
    "QXA = (LSB, MQN)\n" +
    "SLM = (NHH, VCD)\n" +
    "XTF = (RXM, KCF)\n" +
    "NKC = (DQX, DQX)\n" +
    "GCX = (PVC, CVK)\n" +
    "NGG = (SBR, XKB)\n" +
    "JML = (FPS, RNT)\n" +
    "JSC = (FNG, BBR)\n" +
    "FDB = (FJC, QSH)\n" +
    "FBC = (BVR, MBD)\n" +
    "QTD = (HBH, THD)\n" +
    "JRS = (NHC, DGN)\n" +
    "MND = (MCN, CFC)\n" +
    "XCM = (DRF, RQS)\n" +
    "HTG = (JJN, KFM)\n" +
    "SQX = (DRP, NDM)\n" +
    "SQS = (NRJ, LXM)\n" +
    "PHD = (SQL, PQT)\n" +
    "MMB = (FJL, BFD)\n" +
    "KRJ = (MTQ, VPS)\n" +
    "HCQ = (DXP, DKQ)\n" +
    "BHN = (JXJ, PXR)\n" +
    "XKD = (QHG, TCT)\n" +
    "KVR = (HFL, NQK)\n" +
    "QXV = (HNH, FJK)\n" +
    "PNM = (MTJ, DTP)\n" +
    "SJJ = (BLH, LDN)\n" +
    "JPX = (QQL, QHN)\n" +
    "HDF = (SBX, JQT)\n" +
    "HJG = (TLD, XBG)\n" +
    "QJT = (BRN, FTM)\n" +
    "NXH = (MVT, XPK)\n" +
    "RCS = (TSC, TKG)\n" +
    "VJZ = (PVL, CFN)\n" +
    "QXT = (FBM, KJL)\n" +
    "SJG = (RPR, DFV)\n" +
    "LHH = (BBV, KLX)\n" +
    "QSV = (HFN, FRS)\n" +
    "FVJ = (HBH, THD)\n" +
    "FBR = (JHR, XMK)\n" +
    "MVX = (QGB, BNQ)\n" +
    "SQL = (HVJ, DPG)\n" +
    "NVJ = (PFN, JRR)\n" +
    "GXD = (CQJ, HGS)\n" +
    "NRP = (XDR, XLC)\n" +
    "FTX = (RSM, QBB)\n" +
    "LXM = (PBS, HRB)\n" +
    "VPB = (QRG, TVB)\n" +
    "PDS = (LQM, SSV)\n" +
    "XLQ = (QJV, VQD)\n" +
    "RNX = (BBJ, XPJ)\n" +
    "MRD = (NVJ, VJG)\n" +
    "PTQ = (XLC, XDR)\n" +
    "BDJ = (QGJ, BSV)\n" +
    "CFN = (MBB, KXJ)\n" +
    "HDG = (FJG, FJG)\n" +
    "DPT = (RDD, SLM)\n" +
    "QBB = (GXD, VNJ)\n" +
    "BLG = (HTG, RFT)\n" +
    "RNK = (DFV, RPR)\n" +
    "DKD = (CPM, SNF)\n" +
    "VXM = (DSG, JGP)\n" +
    "DPP = (JLK, NPC)\n" +
    "HRB = (FXK, KLJ)\n" +
    "SQD = (HMK, VVH)\n" +
    "LGV = (XKD, CQM)\n" +
    "JHR = (VCT, GKD)\n" +
    "JQT = (QVJ, RJL)\n" +
    "QVJ = (MRH, TGR)\n" +
    "DHG = (SFP, JVQ)\n" +
    "VQD = (FHV, BNS)\n" +
    "NHH = (STQ, VQQ)\n" +
    "CQT = (MPP, NJG)\n" +
    "NVV = (XQR, GQM)\n" +
    "KTX = (QSJ, QSJ)\n" +
    "BHQ = (FVX, DHG)\n" +
    "LJS = (NHC, DGN)\n" +
    "JXH = (KGM, JTX)\n" +
    "CKH = (XNB, PPG)\n" +
    "GML = (LPC, KFT)\n" +
    "LDN = (FMJ, QTT)\n" +
    "KPR = (DPT, CNJ)\n" +
    "CQF = (MJF, RVK)\n" +
    "HXC = (NXH, BSP)\n" +
    "GXT = (MND, NBJ)\n" +
    "HRP = (JRB, XBB)\n" +
    "GRD = (FVX, DHG)\n" +
    "LRP = (XPN, QXV)\n" +
    "HRQ = (QJT, TGT)\n" +
    "PGC = (FNB, HSV)\n" +
    "TSC = (PHJ, FLC)\n" +
    "PDA = (NVV, MSV)\n" +
    "PHJ = (SJJ, DJS)\n" +
    "JRB = (XSF, HSS)\n" +
    "BRN = (TGH, HPH)\n" +
    "RXL = (FJS, MVX)\n" +
    "XTD = (FTN, KTT)\n" +
    "TKV = (QTP, NHM)\n" +
    "JTX = (TQF, DMF)\n" +
    "JHP = (HMK, VVH)\n" +
    "JPN = (TMB, VPV)\n" +
    "SLK = (KKP, GCX)\n" +
    "MBB = (CLD, XBR)\n" +
    "BRQ = (JPX, GHX)\n" +
    "PRK = (GJH, LHX)\n" +
    "CNV = (PLV, VGN)\n" +
    "RQS = (KRG, KQM)\n" +
    "XQF = (BQB, KXX)\n" +
    "JRR = (GQF, XBC)\n" +
    "XMN = (GRP, CQT)\n" +
    "HKK = (CDS, RDF)\n" +
    "XSM = (LMQ, PNM)\n" +
    "NBZ = (QLG, SLK)\n" +
    "CMF = (BPL, FCS)\n" +
    "KLX = (RRV, SXM)\n" +
    "CBF = (CTJ, TCN)\n" +
    "VMM = (GML, KKF)\n" +
    "NQM = (PXR, JXJ)\n" +
    "QPL = (TDJ, MDK)\n" +
    "XXQ = (XXT, TLQ)\n" +
    "MPM = (HFX, TQS)\n" +
    "GQM = (XLV, TCK)\n" +
    "JNB = (JXH, JBT)\n" +
    "MPP = (XSM, FXH)\n" +
    "JSJ = (QPJ, FGL)\n" +
    "DHX = (SJG, RNK)\n" +
    "SKG = (XHS, PDS)\n" +
    "XMK = (GKD, VCT)\n" +
    "FMQ = (TQQ, FSS)\n" +
    "FSH = (DHX, QDM)\n" +
    "FXK = (VRM, SQX)\n" +
    "HBP = (LXM, NRJ)\n" +
    "GJG = (VTT, LJK)\n" +
    "QPJ = (VFX, DVQ)\n" +
    "MVM = (FGK, NBZ)\n" +
    "MSF = (QKP, XMN)\n" +
    "XQJ = (JPN, LJH)\n" +
    "KCJ = (GXT, RMQ)\n" +
    "GXB = (TCN, CTJ)\n" +
    "FFV = (VQS, PHD)\n" +
    "CLD = (NFS, CJM)\n" +
    "CXN = (VBT, BTC)\n" +
    "VPT = (FTR, NDP)\n" +
    "MSM = (VMG, GQH)\n" +
    "QJJ = (KTX, KTX)\n" +
    "NHM = (RCS, MFH)\n" +
    "FTR = (TXS, NGG)\n" +
    "HSV = (MPK, BDX)\n" +
    "LJK = (DKD, KQT)\n" +
    "VQS = (SQL, PQT)\n" +
    "FGL = (DVQ, VFX)\n" +
    "LSS = (PQK, PKV)\n" +
    "JQQ = (BVD, GFK)\n" +
    "JBQ = (HCQ, RQC)\n" +
    "BBJ = (PSR, BRQ)\n" +
    "XBB = (HSS, XSF)\n" +
    "MCN = (DPP, QKL)\n" +
    "BXT = (PGL, HNB)\n" +
    "KHT = (QQC, XXV)\n" +
    "HFP = (CDX, XST)\n" +
    "HFL = (NFG, CKH)\n" +
    "XVB = (FHQ, JXL)\n" +
    "FPQ = (NLS, TLL)\n" +
    "BPK = (RFK, DVP)\n" +
    "SDR = (JSJ, XRB)\n" +
    "FTN = (GLQ, HKK)\n" +
    "MTJ = (QTD, FVJ)\n" +
    "BBV = (SXM, RRV)\n" +
    "HJK = (CMP, DPF)\n" +
    "FJK = (FSH, NMF)\n" +
    "VFN = (FPQ, HTN)\n" +
    "DVP = (VXM, FXL)\n" +
    "XNP = (VJG, NVJ)\n" +
    "MSX = (VKJ, KBL)\n" +
    "FDJ = (DRT, KVM)\n" +
    "JNL = (RXF, FCD)\n" +
    "NKG = (QKP, XMN)\n" +
    "BRL = (DPV, FFN)\n" +
    "NSL = (TKV, KXR)\n" +
    "HHG = (MPM, FQQ)\n" +
    "GCN = (LJF, LJF)\n" +
    "XXV = (TQH, SDH)\n" +
    "RFD = (TGS, GJG)\n" +
    "NMF = (DHX, QDM)\n" +
    "XST = (GHC, HXC)\n" +
    "JFM = (LVJ, FSM)\n" +
    "VVX = (LBN, DLL)\n" +
    "HSS = (XKR, BRL)\n" +
    "MSP = (RXF, FCD)\n" +
    "BSP = (MVT, XPK)\n" +
    "RHQ = (KHT, HCL)\n" +
    "BBG = (VBT, BTC)\n" +
    "XXP = (LSB, MQN)\n" +
    "JGP = (VFN, XCD)\n" +
    "JSD = (BHQ, GRD)\n" +
    "DGN = (HMG, HPG)\n" +
    "HVJ = (QJB, VRL)\n" +
    "RDQ = (TRF, HJF)\n" +
    "VFP = (HBP, SQS)\n" +
    "XRB = (QPJ, FGL)\n" +
    "DMD = (MCS, RFD)\n" +
    "FLC = (SJJ, DJS)\n" +
    "VVH = (RPG, CXP)\n" +
    "FHJ = (JPV, PXZ)\n" +
    "MRH = (VPB, QFM)\n" +
    "QTT = (TXT, MFD)\n" +
    "HPH = (CCX, SKG)\n" +
    "HTC = (VMG, GQH)\n" +
    "RBF = (VXX, KRJ)\n" +
    "GFJ = (KTX, QPV)\n" +
    "QHG = (XLS, LXJ)\n" +
    "RFK = (VXM, FXL)\n" +
    "DKB = (BFD, FJL)\n" +
    "HRF = (KHC, RXL)\n" +
    "MKQ = (NKG, MSF)\n" +
    "JHQ = (BXH, XQF)\n" +
    "FVX = (SFP, JVQ)\n" +
    "VVR = (KJL, FBM)\n" +
    "XLC = (MNC, XVB)\n" +
    "LQD = (TCP, ZZZ)\n" +
    "GMH = (QCT, GHQ)\n" +
    "QDM = (RNK, SJG)\n" +
    "PRQ = (TTC, TXJ)\n" +
    "FCD = (CLR, NVB)\n" +
    "DTP = (FVJ, QTD)\n" +
    "JFF = (RXB, CLP)\n" +
    "XGG = (FSS, TQQ)\n" +
    "TLD = (GPH, XTF)\n" +
    "MXL = (LSF, FSQ)\n" +
    "FLJ = (JFF, CFH)\n" +
    "NGT = (KTT, FTN)\n" +
    "RLN = (PLG, HHG)\n" +
    "STQ = (VDC, HRP)\n" +
    "TCK = (VTR, TGD)\n" +
    "PQK = (FGP, TBN)\n" +
    "FJL = (FBC, MXF)\n" +
    "MJX = (PLV, VGN)\n" +
    "MFD = (GHH, FTB)\n" +
    "XBZ = (MSV, NVV)\n" +
    "NXL = (LJF, THM)\n" +
    "KLJ = (SQX, VRM)\n" +
    "TCN = (MRG, XFM)\n" +
    "CTJ = (XFM, MRG)\n" +
    "QBH = (SVK, CFT)\n" +
    "GRV = (NDC, SDR)\n" +
    "TFD = (BHN, NQM)\n" +
    "SJD = (SDR, NDC)\n" +
    "LHQ = (HDG, HXL)\n" +
    "TVS = (NSL, GKH)\n" +
    "NST = (MJF, RVK)\n" +
    "GJH = (FXR, FDJ)\n" +
    "NGR = (PSP, HST)\n" +
    "QGJ = (TNT, JNR)\n" +
    "HTR = (PGL, HNB)\n" +
    "SFP = (NRP, PTQ)\n" +
    "CTR = (MHF, QBH)\n" +
    "CJM = (KXN, HFQ)\n" +
    "HNB = (BNM, LSS)\n" +
    "PSS = (FDV, JFM)\n" +
    "JPB = (FPS, RNT)\n" +
    "RQC = (DKQ, DXP)\n" +
    "NRD = (JQT, SBX)\n" +
    "NGV = (VMJ, NSJ)\n" +
    "VCD = (STQ, VQQ)\n" +
    "TXB = (QCQ, JTT)\n" +
    "TKX = (JPB, JML)\n" +
    "LQH = (PGC, FQD)\n" +
    "DPV = (DCG, XBD)\n" +
    "VQQ = (HRP, VDC)\n" +
    "FQD = (FNB, HSV)\n" +
    "HXH = (DRF, RQS)\n" +
    "GNM = (CLC, CLC)\n" +
    "XLS = (DKB, MMB)\n" +
    "SVK = (CMF, MNS)\n" +
    "NFG = (XNB, PPG)\n" +
    "DRB = (XJV, VHV)\n" +
    "GHH = (MFF, DQT)\n" +
    "SHG = (RFT, HTG)\n" +
    "PLM = (QCQ, JTT)\n" +
    "LPC = (JRT, MHM)\n" +
    "SDH = (DKT, HGB)\n" +
    "GRR = (TDJ, MDK)\n" +
    "TQF = (NKD, JNC)\n" +
    "VTT = (DKD, KQT)\n" +
    "THD = (XGF, DVJ)\n" +
    "KFQ = (RFD, MCS)\n" +
    "DJS = (BLH, LDN)\n" +
    "CHS = (JSD, XXK)\n" +
    "BFD = (FBC, MXF)\n" +
    "PCP = (TLV, VNT)\n" +
    "PVH = (TTR, XPV)\n" +
    "FHB = (KND, PGH)\n" +
    "FFN = (XBD, DCG)\n" +
    "TBN = (GRR, QPL)\n" +
    "HFN = (NNB, QXB)\n" +
    "NJG = (XSM, FXH)\n" +
    "FXH = (PNM, LMQ)\n" +
    "GHC = (BSP, NXH)\n" +
    "MFT = (CTR, JDS)\n" +
    "QCT = (PCP, GJC)\n" +
    "DRX = (CTK, RDS)\n" +
    "GQJ = (SHG, BLG)\n" +
    "RXB = (BHB, HFP)\n" +
    "TDA = (CFN, PVL)\n" +
    "LQF = (CNV, MJX)\n" +
    "LJF = (FDM, FDM)\n" +
    "CLC = (SKR, SKR)\n" +
    "TCT = (LXJ, XLS)\n" +
    "HCL = (QQC, XXV)\n" +
    "CDX = (GHC, HXC)\n" +
    "XKR = (DPV, FFN)\n" +
    "DKQ = (VVX, PFQ)\n" +
    "TQV = (JMC, VFP)\n" +
    "MXF = (BVR, MBD)\n" +
    "LLX = (TKX, GFR)\n" +
    "CLR = (KQJ, RDQ)\n" +
    "FNG = (KPN, DMK)\n" +
    "DMF = (JNC, NKD)\n" +
    "XQR = (TCK, XLV)\n" +
    "MNS = (BPL, FCS)\n" +
    "XDR = (XVB, MNC)\n" +
    "KCF = (BXT, HTR)\n" +
    "TGH = (SKG, CCX)\n" +
    "TTC = (CBF, GXB)\n" +
    "GRP = (NJG, MPP)\n" +
    "NPC = (FPF, LRP)\n" +
    "JGS = (PBN, PBN)\n" +
    "DBS = (JLC, MQG)\n" +
    "JVQ = (NRP, PTQ)\n" +
    "HMG = (DSS, PRQ)\n" +
    "KGM = (DMF, TQF)\n" +
    "MQN = (XLQ, FQF)\n" +
    "TDJ = (GNM, GNM)\n" +
    "PFN = (GQF, XBC)\n" +
    "BTX = (JSD, XXK)\n" +
    "FDM = (FGK, FGK)\n" +
    "RDF = (RRS, CCF)\n" +
    "GPH = (RXM, KCF)\n" +
    "FLM = (GML, KKF)\n" +
    "VJG = (PFN, JRR)\n" +
    "XFM = (LPH, GQJ)\n" +
    "TNT = (VMM, FLM)\n" +
    "CNJ = (SLM, RDD)\n" +
    "CLJ = (DPT, CNJ)\n" +
    "XFN = (HDG, HDG)\n" +
    "HNQ = (PRK, CSP)\n" +
    "DRF = (KQM, KRG)\n" +
    "RDS = (JLT, HRF)\n" +
    "XJV = (LLX, GVC)\n" +
    "SHJ = (CNV, MJX)\n" +
    "NQK = (NFG, CKH)\n" +
    "XXX = (GRL, RHS)\n" +
    "GJC = (TLV, VNT)\n" +
    "SNF = (MTM, DJK)\n" +
    "KXR = (QTP, NHM)\n" +
    "PVL = (MBB, KXJ)\n" +
    "MSV = (GQM, XQR)\n" +
    "JSL = (HCQ, RQC)\n" +
    "LLV = (KDD, LMB)\n" +
    "HTN = (TLL, NLS)\n" +
    "KQJ = (TRF, HJF)\n" +
    "NKT = (HFN, FRS)\n" +
    "GKD = (BHF, RHQ)\n" +
    "QHT = (BSV, QGJ)\n" +
    "HHS = (TPT, MKQ)\n" +
    "CCF = (QXT, VVR)\n" +
    "DRP = (VVL, TFD)\n" +
    "NFS = (HFQ, KXN)\n" +
    "MFH = (TSC, TKG)\n" +
    "TXJ = (GXB, CBF)\n" +
    "BNM = (PKV, PQK)\n" +
    "TGT = (BRN, FTM)\n" +
    "SJF = (PGC, FQD)\n" +
    "CCX = (PDS, XHS)\n" +
    "FQF = (VQD, QJV)\n" +
    "LSB = (XLQ, FQF)\n" +
    "LBN = (MFK, HHS)\n" +
    "HBH = (DVJ, XGF)\n" +
    "NSJ = (TDN, JTF)\n" +
    "TLV = (SJF, LQH)\n" +
    "BVR = (RNX, KRN)\n" +
    "PLG = (FQQ, MPM)\n" +
    "KTT = (GLQ, HKK)\n" +
    "GQH = (GCN, NXL)\n" +
    "BLH = (FMJ, QTT)\n" +
    "PFQ = (LBN, DLL)\n" +
    "CMP = (PSS, THS)\n" +
    "KPX = (RHS, GRL)\n" +
    "FNB = (MPK, BDX)\n" +
    "KDD = (CMK, RHK)\n" +
    "TKG = (PHJ, FLC)\n" +
    "CXX = (TQV, NBV)\n" +
    "DQT = (JNL, MSP)\n" +
    "HXL = (FJG, FHJ)\n" +
    "NSS = (TGT, QJT)\n" +
    "QKP = (CQT, GRP)\n" +
    "JJN = (KKQ, FFV)\n" +
    "NLM = (SKR, VJZ)\n" +
    "XGF = (XDG, LGV)\n" +
    "BJG = (NKT, QSV)\n" +
    "LDQ = (KDD, LMB)\n" +
    "LSF = (DDL, HJG)\n" +
    "TQQ = (FQX, BDD)\n" +
    "HMK = (CXP, RPG)\n" +
    "ZZZ = (RLN, BNG)\n" +
    "DKT = (NSS, HRQ)\n" +
    "LMB = (CMK, RHK)\n" +
    "MBJ = (XQF, BXH)\n" +
    "KHJ = (GPD, JNB)\n" +
    "KQM = (NST, CQF)\n" +
    "SPH = (PRK, CSP)\n" +
    "KSD = (HST, PSP)\n" +
    "QLG = (GCX, KKP)\n" +
    "RXF = (CLR, NVB)\n" +
    "BXH = (BQB, KXX)\n" +
    "JKC = (XGG, FMQ)\n" +
    "BPL = (JSC, HLV)\n" +
    "JPV = (QHT, BDJ)\n" +
    "QQA = (QHT, BDJ)\n" +
    "DPF = (THS, PSS)\n" +
    "MHM = (LDQ, LLV)\n" +
    "FJG = (JPV, JPV)\n" +
    "QTP = (MFH, RCS)\n" +
    "SMD = (XXP, XXP)\n" +
    "VXX = (MTQ, VPS)\n" +
    "FPF = (XPN, QXV)\n" +
    "VFX = (BBG, CXN)\n" +
    "DSS = (TTC, TXJ)\n" +
    "RLC = (VXX, KRJ)\n" +
    "CFH = (RXB, CLP)\n" +
    "DCG = (LQF, SHJ)\n" +
    "QHN = (NGT, XTD)\n" +
    "JNK = (QCT, GHQ)\n" +
    "FXL = (DSG, JGP)\n" +
    "RNV = (MXL, HBR)\n" +
    "TVL = (DVR, KCJ)\n" +
    "KCQ = (SMD, HQV)\n" +
    "KXJ = (CLD, XBR)\n" +
    "FGP = (GRR, QPL)\n" +
    "KVM = (MXJ, PKS)\n" +
    "DVR = (GXT, RMQ)\n" +
    "KJL = (SQH, JMS)\n" +
    "QQC = (SDH, TQH)\n" +
    "GNT = (MGL, JGQ)\n" +
    "KRG = (CQF, NST)\n" +
    "LXJ = (DKB, MMB)\n" +
    "XXT = (FPD, DRB)\n" +
    "CDS = (RRS, CCF)\n" +
    "KBL = (JQQ, JST)\n" +
    "DDL = (XBG, TLD)\n" +
    "DSG = (VFN, XCD)\n" +
    "GHX = (QHN, QQL)\n" +
    "BNG = (PLG, HHG)\n" +
    "MGL = (CLJ, KPR)\n" +
    "VCT = (RHQ, BHF)\n" +
    "PHR = (CLC, NLM)\n" +
    "VXQ = (FBR, TNJ)\n" +
    "GLC = (DPF, CMP)\n" +
    "QPV = (QSJ, LQD)\n" +
    "MTQ = (CXX, HDP)\n" +
    "JXJ = (LLL, JCJ)\n" +
    "LJJ = (HBR, MXL)\n" +
    "VPV = (DMD, KFQ)\n" +
    "JST = (BVD, GFK)\n" +
    "QQL = (NGT, XTD)\n" +
    "FHQ = (TXB, PLM)\n" +
    "VRL = (DBS, JFR)\n" +
    "MTF = (QSV, NKT)\n" +
    "XBG = (GPH, XTF)\n" +
    "PBN = (NVV, MSV)\n" +
    "TLQ = (FPD, DRB)\n" +
    "JBT = (JTX, KGM)\n" +
    "RSM = (VNJ, GXD)\n" +
    "BBR = (KPN, DMK)\n" +
    "DJK = (KLV, FLJ)\n" +
    "SKR = (CFN, PVL)\n" +
    "PKV = (TBN, FGP)\n" +
    "FBM = (SQH, JMS)\n" +
    "GLQ = (RDF, CDS)\n" +
    "NHC = (HMG, HPG)\n" +
    "VDC = (JRB, XBB)\n" +
    "KXN = (HDF, NRD)\n" +
    "DPG = (VRL, QJB)\n" +
    "QCQ = (GMH, JNK)\n" +
    "SSV = (GNT, RSS)\n" +
    "NDP = (TXS, NGG)\n" +
    "XBD = (LQF, SHJ)\n" +
    "XDG = (XKD, CQM)\n" +
    "CLP = (BHB, HFP)\n" +
    "PVC = (CHS, BTX)\n" +
    "CQM = (QHG, TCT)\n" +
    "GKH = (TKV, KXR)\n" +
    "LPH = (SHG, BLG)\n" +
    "NVQ = (CTR, JDS)\n" +
    "TVB = (MBJ, JHQ)\n" +
    "QSH = (TVS, LLP)\n" +
    "XPN = (FJK, HNH)\n" +
    "BNQ = (HNQ, SPH)\n" +
    "SCX = (RLC, RBF)\n" +
    "QKL = (JLK, NPC)\n" +
    "MFK = (MKQ, TPT)\n" +
    "MJF = (KVR, MHT)\n" +
    "QSJ = (TCP, TCP)\n" +
    "STX = (SCX, HCV)\n" +
    "PSR = (GHX, JPX)\n" +
    "TQS = (KDV, LHH)\n" +
    "JFR = (JLC, MQG)\n" +
    "JTT = (JNK, GMH)\n" +
    "PGH = (QMF, TVL)\n" +
    "TXS = (XKB, SBR)\n" +
    "PKS = (MSX, CFS)\n" +
    "CFS = (VKJ, KBL)\n" +
    "JLT = (KHC, RXL)\n" +
    "GRL = (SGG, JKC)\n" +
    "LJH = (TMB, VPV)\n" +
    "MPK = (MFB, NGV)\n" +
    "CQL = (GPD, JNB)\n" +
    "MXJ = (CFS, MSX)\n" +
    "HBR = (FSQ, LSF)\n" +
    "KPN = (MVC, XQJ)\n" +
    "FPD = (VHV, XJV)\n" +
    "MDK = (GNM, PHR)\n" +
    "HGS = (STX, XQN)\n" +
    "NBV = (JMC, VFP)\n" +
    "RRV = (GLC, HJK)\n" +
    "TGD = (VPT, BBH)\n" +
    "PPA = (SLK, QLG)\n" +
    "SVF = (TNJ, FBR)\n" +
    "LCL = (CTK, RDS)\n" +
    "RHS = (JKC, SGG)\n" +
    "KKQ = (VQS, PHD)\n" +
    "JCJ = (KSD, NGR)\n" +
    "AAA = (BNG, RLN)\n" +
    "MRG = (GQJ, LPH)\n" +
    "HLV = (FNG, BBR)\n" +
    "VNP = (QBB, RSM)\n" +
    "VNT = (SJF, LQH)\n" +
    "GHQ = (GJC, PCP)\n" +
    "CPM = (DJK, MTM)\n" +
    "VVL = (BHN, NQM)\n" +
    "JTF = (KPX, XXX)\n" +
    "FFQ = (XXT, TLQ)\n" +
    "TXT = (FTB, GHH)\n" +
    "TGR = (VPB, QFM)\n" +
    "VTR = (BBH, VPT)\n" +
    "SBR = (JBQ, JSL)\n" +
    "FRS = (QXB, NNB)\n" +
    "JDS = (QBH, MHF)\n" +
    "GFK = (FDB, BXB)\n" +
    "TCP = (BNG, RLN)\n" +
    "RDD = (NHH, VCD)\n" +
    "CDF = (JGS, JGS)\n" +
    "NDM = (TFD, VVL)\n" +
    "TLL = (NVQ, MFT)\n" +
    "QJV = (FHV, BNS)\n" +
    "PSP = (LJJ, RNV)\n" +
    "NDC = (JSJ, XRB)\n" +
    "GVC = (TKX, GFR)\n" +
    "VQP = (DVP, RFK)\n" +
    "FTM = (TGH, HPH)\n" +
    "QMF = (DVR, KCJ)\n" +
    "HGB = (HRQ, NSS)\n" +
    "CVK = (BTX, CHS)\n" +
    "JNC = (HQM, PVH)\n" +
    "FJC = (TVS, LLP)\n" +
    "RPG = (FTX, VNP)\n" +
    "PGL = (BNM, LSS)\n" +
    "DXP = (PFQ, VVX)\n" +
    "JGQ = (CLJ, KPR)\n" +
    "TGS = (LJK, VTT)\n" +
    "BXB = (FJC, QSH)\n" +
    "QGB = (SPH, HNQ)\n" +
    "HJF = (QJJ, GFJ)\n" +
    "JMS = (MRD, XNP)\n" +
    "THM = (FDM, MVM)\n" +
    "KKP = (CVK, PVC)\n" +
    "RNT = (MSM, HTC)\n" +
    "HDP = (NBV, TQV)\n" +
    "NRJ = (HRB, PBS)\n" +
    "HCV = (RBF, RLC)\n" +
    "MFF = (JNL, MSP)\n" +
    "SXM = (HJK, GLC)\n" +
    "TRF = (QJJ, GFJ)\n" +
    "KFT = (JRT, MHM)\n" +
    "PBS = (KLJ, FXK)\n" +
    "QRG = (JHQ, MBJ)\n" +
    "QJB = (DBS, JFR)\n" +
    "FSQ = (DDL, HJG)\n" +
    "VHV = (LLX, GVC)\n" +
    "CFT = (CMF, MNS)\n" +
    "KXX = (SBS, DXN)\n" +
    "MHT = (HFL, NQK)\n" +
    "SLR = (PBN, XBZ)\n" +
    "BDX = (NGV, MFB)\n" +
    "MVC = (LJH, JPN)\n" +
    "DRT = (PKS, MXJ)\n" +
    "VNJ = (HGS, CQJ)\n" +
    "XBC = (CDF, VJF)\n" +
    "LVJ = (XCM, HXH)\n" +
    "DVQ = (BBG, CXN)\n" +
    "HST = (LJJ, RNV)\n" +
    "QFM = (QRG, TVB)\n" +
    "RSS = (MGL, JGQ)\n" +
    "RJL = (TGR, MRH)\n" +
    "KDV = (BBV, KLX)\n" +
    "TPT = (NKG, MSF)\n" +
    "VMJ = (TDN, JTF)\n" +
    "VKJ = (JQQ, JST)\n" +
    "LMQ = (DTP, MTJ)\n" +
    "BHB = (XST, CDX)\n" +
    "PXR = (LLL, JCJ)\n" +
    "KRN = (BBJ, XPJ)\n" +
    "BSV = (JNR, TNT)\n" +
    "FHV = (VXQ, SVF)\n" +
    "TMB = (KFQ, DMD)\n" +
    "FSM = (XCM, HXH)\n" +
    "JMC = (HBP, SQS)\n" +
    "NBJ = (CFC, MCN)\n" +
    "LLL = (KSD, NGR)\n" +
    "XQN = (HCV, SCX)\n" +
    "CQJ = (STX, XQN)\n" +
    "DVJ = (LGV, XDG)\n" +
    "SGG = (FMQ, XGG)\n" +
    "KQT = (SNF, CPM)\n" +
    "XPK = (XFN, LHQ)\n" +
    "GQF = (CDF, CDF)\n" +
    "PPG = (DRX, LCL)\n" +
    "NLS = (MFT, NVQ)\n" +
    "HPG = (DSS, PRQ)\n" +
    "TNJ = (JHR, XMK)\n" +
    "JXL = (PLM, TXB)\n" +
    "LLP = (NSL, GKH)\n" +
    "XKB = (JSL, JBQ)\n" +
    "VMG = (GCN, NXL)\n" +
    "DMK = (MVC, XQJ)\n" +
    "MNC = (JXL, FHQ)\n" +
    "BBH = (NDP, FTR)\n" +
    "JLK = (LRP, FPF)\n" +
    "SBS = (JHP, SQD)\n" +
    "HFQ = (NRD, HDF)\n" +
    "MBD = (RNX, KRN)\n" +
    "BDD = (GDV, FHB)\n" +
    "MFB = (VMJ, NSJ)\n" +
    "JLC = (BPK, VQP)\n" +
    "XCD = (HTN, FPQ)\n" +
    "GPD = (JXH, JBT)\n" +
    "DXN = (JHP, SQD)\n" +
    "FCS = (JSC, HLV)\n" +
    "FMJ = (MFD, TXT)\n" +
    "MQG = (VQP, BPK)\n" +
    "BQB = (SBS, DXN)\n" +
    "MTM = (KLV, FLJ)\n" +
    "FSS = (BDD, FQX)\n" +
    "MHF = (SVK, CFT)\n" +
    "FDV = (LVJ, FSM)\n" +
    "PLV = (GRV, SJD)\n" +
    "XPJ = (BRQ, PSR)\n" +
    "VJF = (JGS, SLR)\n" +
    "XLV = (VTR, TGD)";

let example =
    "RL\n" +
    "\n" +
    "AAA = (BBB, CCC)\n" +
    "BBB = (DDD, EEE)\n" +
    "CCC = (ZZZ, GGG)\n" +
    "DDD = (DDD, DDD)\n" +
    "EEE = (EEE, EEE)\n" +
    "GGG = (GGG, GGG)\n" +
    "ZZZ = (ZZZ, ZZZ)";

let example2 =
    "LRR\n" +
    "AAA = (BBB, ZZZ)\n" +
    "BBB = (CCC, ZZZ)\n" +
    "ZZZ = (CCC, XXZ)\n" +
    "XXA = (CCC, AAA)\n" +
    "CCC = (ZZZ, BBB)\n" +
    "XXZ = (BBB, ZZZ)"

// let array = example.split('\n');
// let array = example2.split('\n');
let array = input.split('\n');

let instructions = array.shift().split('');

array.shift();

let assArray = []

array.forEach(node => {
    let temporalArray = node.split(' = ');
    assArray[temporalArray[0]] = temporalArray[1];
})

for (let key in assArray) {
    assArray[key] = assArray[key].replace(/\(/g, '').replace(/\)/g, '').split(", ");
}

let actual = 'AAA';
let steps = 0;
let lastInstruction = 0

while (actual !== 'ZZZ') {
    steps++;

    if (lastInstruction < instructions.length - 1) {
        if (instructions[lastInstruction] === 'L') actual = assArray[actual][0]
        if (instructions[lastInstruction] === 'R') actual = assArray[actual][1]
        lastInstruction++
        continue;
    }
    if (lastInstruction === instructions.length - 1) {
        if (instructions[lastInstruction] === 'L') actual = assArray[actual][0]
        if (instructions[lastInstruction] === 'R') actual = assArray[actual][1]
        lastInstruction = 0
    }
}

console.log(steps);




